<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="light" />
  <meta name="theme-color" content="#F4F4F4" />
  <title>Yanapanakunchik - Comercio Justo en Cusco</title>
  <link rel="stylesheet" href="styles-optimized.css" />
  <style>
    /* Cookie Consent Banner */
    .cookie-consent-banner {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(25, 25, 25, 0.9);
      backdrop-filter: blur(8px);
      color: #fff;
      padding: 1.25rem;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.25rem;
      z-index: 3000;
      transform: translateY(100%);
      transition: transform 0.5s ease-in-out;
      flex-wrap: wrap;
      text-align: center;
    }
    .cookie-consent-banner.show {
      transform: translateY(0);
    }
    .cookie-consent-banner p {
      margin: 0;
      font-size: 0.95em;
      flex-grow: 1;
    }
    .cookie-consent-banner .buttons {
      display: flex;
      gap: 0.75rem;
      flex-shrink: 0;
    }
    .cookie-consent-banner button {
      width: auto;
      padding: 0.6rem 1.2rem;
      border-radius: 50px;
      font-weight: 600;
      cursor: pointer;
    }
    .cookie-consent-banner .accept-btn {
      background: var(--accent-color);
      color: white;
    }
    .cookie-consent-banner .reject-btn {
      background: #444;
      color: white;
    }
  </style>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <div class="logo">
        <h1>Yanapanakunchik</h1>
      </div>
      <nav class="main-nav">
        <a href="#objetivo">Nuestro Objetivo</a>
        <a href="sobre-nosotros.html">Sobre Nosotros</a>
        <a href="tienda.html">Tienda</a>
        <a href="blog.html">Blog</a>
        <a href="contacto.html">Contacto</a>
      </nav>
      <div class="auth-actions" id="auth-actions">
        <button class="login-button" id="open-login-modal">Iniciar sesi√≥n</button>
      </div>
      <div id="auth-container" style="display:none">
          <div id="g_id_signin" style="display:none"></div>
          <div id="user-profile" style="display: none;">
              <img id="user-pic" src="" alt="User Picture">
              <span id="user-name"></span>
              <button id="logout-button" onclick="signOut();">Cerrar Sesi√≥n</button>
          </div>
      </div>
    </div>
  </header>

  <main>
    <section id="hero">
      <div class="container">
        <div class="hero-content">
          <h2>Ayudando a crecer a los emprendedores del Cusco</h2>
          <p>Promovemos el comercio justo y sostenible para mejorar la calidad de vida de los emprendedores locales.</p>
          <a href="tienda.html" class="cta-button">Explora nuestros productos</a>
        </div>
      </div>
    </section>

    <section id="objetivo" class="page-section">
      <div class="container">
        <h2>Nuestro Objetivo</h2>
        <div class="objetivo-content">
          <div class="objetivo-text">
            <h3>Misi√≥n y Visi√≥n</h3>
            <p>Nuestra misi√≥n es crear un puente directo entre los talentosos emprendedores del Cusco y t√∫. Buscamos eliminar intermediarios para asegurar un pago justo y un desarrollo sostenible para los grandes emprendedores de todo cusco. Creemos en un comercio que respeta la cultura, la tradici√≥n y el medio ambiente.</p>
            <div style="margin-top: 2rem;">
              <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                <div style="background: var(--hero-gradient); color: white; padding: 1rem; border-radius: var(--radius); flex: 1; text-align: center;">
                  <h4 style="margin-bottom: 0.5rem;">üéØ Comercio Justo</h4>
                  <p style="font-size: 0.9rem; margin: 0;">Precios justos para productores</p>
                </div>
                <div style="background: var(--hero-gradient); color: white; padding: 1rem; border-radius: var(--radius); flex: 1; text-align: center;">
                  <h4 style="margin-bottom: 0.5rem;">üå± Sostenibilidad</h4>
                  <p style="font-size: 0.9rem; margin: 0;">Respeto por el medio ambiente</p>
                </div>
              </div>
              <div style="display: flex; gap: 1rem;">
                <div style="background: var(--hero-gradient); color: white; padding: 1rem; border-radius: var(--radius); flex: 1; text-align: center;">
                  <h4 style="margin-bottom: 0.5rem;">üèõÔ∏è Cultura</h4>
                  <p style="font-size: 0.9rem; margin: 0;">Preservaci√≥n de tradiciones</p>
                </div>
                <div style="background: var(--hero-gradient); color: white; padding: 1rem; border-radius: var(--radius); flex: 1; text-align: center;">
                  <h4 style="margin-bottom: 0.5rem;">ü§ù Comunidad</h4>
                  <p style="font-size: 0.9rem; margin: 0;">Desarrollo local sostenible</p>
                </div>
              </div>
            </div>
          </div>
          <div class="objetivo-image">
            <img src="photos/plaza_armas_cusco.jpg" alt="Plaza de Armas del Cusco - Coraz√≥n de nuestra comunidad" style="border-radius: var(--radius-lg); box-shadow: var(--shadow-xl);" />
          </div>
        </div>
      </div>
    </section>

    <!-- 
      PASO 2: Aqu√≠ podr√≠as colocar un bloque de anuncio.
      Ser√≠a un espacio de publicidad entre la secci√≥n "Nuestro Objetivo" y "Personas Ayudadas".
      El c√≥digo se ver√≠a algo as√≠:
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-xxxxxxxxxxxxxxxx"
           data-ad-slot="1234567890"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    -->

    <section id="ayudados" class="page-section">
      <div class="container">
        <h2>Emprendedores Apoyados</h2>
        <div class="personas-ayudadas">
            <div class="persona">
                <img src="https://images.unsplash.com/photo-1580618672591-eb180b1a973f?w=150&h=150&fit=crop&crop=face" alt="Mar√≠a Quispe" />
                <h4>Mar√≠a Quispe</h4>
                <p>"Gracias a Yanapanakunchik, he podido vender mis tejidos a un precio justo y mantener a mi familia. Siento que mi trabajo es valorado."</p>
            </div>
            <div class="persona">
                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face" alt="Juan Carlos" />
                <h4>Juan Carlos</h4>
                <p>"La plataforma me ha permitido llegar a clientes que antes eran inalcanzables. Mis cer√°micas ahora se venden en todo el Per√∫."</p>
            </div>
            <div class="persona">
                <img src="https://images.unsplash.com/photo-1517486808906-6ca8b3f04846?w=150&h=150&fit=crop&crop=face" alt="Familia Mamani" />
                <h4>Familia Mamani</h4>
                <p>"Como familia, hemos podido organizarnos y mejorar nuestra producci√≥n. Yanapanakunchik nos ha dado el apoyo que necesit√°bamos."</p>
            </div>
        </div>
      </div>
    </section>

    <section id="integrantes" class="page-section">
      <div class="container">
        <h2>Integrantes</h2>
        <div class="integrantes-container">
          <div class="integrante">
            <img src="photos/Naomi Adriana Cusi Sullca.jpg" alt="Naomi Adriana Cusi Sullca" />
            <h4>Naomi Adriana Cusi Sullca</h4>
            <p>Gerente General</p>
          </div>
          <div class="integrante">
            <img src="photos/Yhon Franco Gomez Colquer.jpg" alt="Yhon Franco Gomez Colquer" />
            <h4>Yhon Franco Gomez Colquer</h4>
            <p>Gerente de Recursos Humanos</p>
          </div>
          <div class="integrante">
            <img src="photos/Daniela Sami Cusihuallpa Cusicuna.jpg" alt="Daniela Sami Cusihuallpa Cusicuna" />
            <h4>Daniela Sami Cusihuallpa Cusicuna</h4>
            <p>Gerente de Marketing</p>
          </div>
          <div class="integrante">
            <img src="photos/Abraham Huallpa Sullo.jpg" alt="Abraham Huallpa Sullo" />
            <h4>Abraham Huallpa Sullo</h4>
            <p>Gerente de T.I.</p>
          </div>
          <div class="integrante">
            <img src="photos/Solange Yadira Cueva Chacmani.jpg" alt="Solange Yadira Cueva Chacmani" />
            <h4>Solange Yadira Cueva Chacmani</h4>
            <p>Gerente de Finanzas</p>
          </div>
        </div>
      </div>
    </section>

    <section id="productos-destacados" class="page-section" style="background: #f8f9fa;">
      <div class="container">
        <h2>Productos Destacados del Cusco</h2>
        <p style="text-align: center; margin-bottom: 3rem; color: #666;">Descubre la riqueza cultural y artesanal de nuestros emprendedores</p>
        
        <div class="productos-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; margin-top: 2rem;">
          <div class="producto-card" style="background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
            <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop" alt="Textiles del Cusco" style="width: 100%; height: 200px; object-fit: cover;" />
            <div style="padding: 1.5rem;">
              <h4 style="color: var(--accent-color); margin-bottom: 0.5rem;">Textiles Tradicionales</h4>
              <p style="color: #666; line-height: 1.6;">Hermosos tejidos elaborados con t√©cnicas ancestrales, utilizando lana de alpaca y tintes naturales.</p>
            </div>
          </div>
          
          <div class="producto-card" style="background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
            <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop" alt="Cer√°mica Cusque√±a" style="width: 100%; height: 200px; object-fit: cover;" />
            <div style="padding: 1.5rem;">
              <h4 style="color: var(--accent-color); margin-bottom: 0.5rem;">Cer√°mica Artesanal</h4>
              <p style="color: #666; line-height: 1.6;">Piezas √∫nicas de cer√°mica con dise√±os inspirados en la cultura inca y colonial.</p>
            </div>
          </div>
          
          <div class="producto-card" style="background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.3s ease;">
            <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop" alt="Joyer√≠a Andina" style="width: 100%; height: 200px; object-fit: cover;" />
            <div style="padding: 1.5rem;">
              <h4 style="color: var(--accent-color); margin-bottom: 0.5rem;">Joyer√≠a Andina</h4>
              <p style="color: #666; line-height: 1.6;">Piezas de joyer√≠a elaboradas con plata y piedras semipreciosas de los Andes.</p>
            </div>
          </div>
        </div>
        
        <div style="text-align: center; margin-top: 3rem;">
          <a href="tienda.html" class="cta-button">Ver Todos los Productos</a>
        </div>
      </div>
    </section>

    <!-- Secci√≥n de Estad√≠sticas Impactantes -->
    <section id="estadisticas" class="page-section" style="background: var(--hero-gradient); color: white; text-align: center;">
      <div class="container">
        <h2 style="color: white; margin-bottom: 3rem;">Nuestro Impacto en N√∫meros</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 3rem; margin-top: 3rem;">
          <div class="stat-card" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 2.5rem 1.5rem; border-radius: var(--radius-lg); border: 1px solid rgba(255, 255, 255, 0.2);">
            <div style="font-size: 3.5rem; font-weight: 900; margin-bottom: 1rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">150+</div>
            <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem;">Emprendedores</h4>
            <p style="opacity: 0.9; font-size: 0.9rem;">Familias beneficiadas directamente</p>
          </div>
          <div class="stat-card" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 2.5rem 1.5rem; border-radius: var(--radius-lg); border: 1px solid rgba(255, 255, 255, 0.2);">
            <div style="font-size: 3.5rem; font-weight: 900; margin-bottom: 1rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">500+</div>
            <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem;">Productos</h4>
            <p style="opacity: 0.9; font-size: 0.9rem;">Artesan√≠as √∫nicas disponibles</p>
          </div>
          <div class="stat-card" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 2.5rem 1.5rem; border-radius: var(--radius-lg); border: 1px solid rgba(255, 255, 255, 0.2);">
            <div style="font-size: 3.5rem; font-weight: 900; margin-bottom: 1rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">95%</div>
            <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem;">Satisfacci√≥n</h4>
            <p style="opacity: 0.9; font-size: 0.9rem;">De nuestros clientes</p>
          </div>
          <div class="stat-card" style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 2.5rem 1.5rem; border-radius: var(--radius-lg); border: 1px solid rgba(255, 255, 255, 0.2);">
            <div style="font-size: 3.5rem; font-weight: 900; margin-bottom: 1rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">1</div>
            <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem;">A√±os</h4>
            <p style="opacity: 0.9; font-size: 0.9rem;">Transformando vidas</p>
          </div>
        </div>
      </div>
    </section>

    <section id="galeria-cusco" class="page-section">
      <div class="container">
        <h2>Galer√≠a del Cusco</h2>
        <p style="text-align: center; margin-bottom: 3rem; color: #666;">Conoce los lugares y la cultura que inspiran a nuestros emprendedores</p>
        
        <div class="galeria-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
          <div class="galeria-item" style="position: relative; overflow: hidden; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); transition: var(--transition);">
            <img src="photos/plaza_armas_cusco.jpg" alt="Plaza de Armas del Cusco - Coraz√≥n hist√≥rico" style="width: 100%; height: 250px; object-fit: cover; transition: var(--transition);" />
            <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white; padding: 1.5rem;">
              <h4 style="font-weight: 700; margin-bottom: 0.5rem;">Plaza de Armas</h4>
              <p style="font-size: 0.9rem; opacity: 0.9; margin: 0;">Coraz√≥n hist√≥rico del Cusco</p>
            </div>
          </div>
          
          <div class="galeria-item" style="position: relative; overflow: hidden; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); transition: var(--transition);">
            <img src="https://images.unsplash.com/photo-1582034662971-906d80d5b545?w=400&h=300&fit=crop" alt="Mercado de San Pedro" style="width: 100%; height: 250px; object-fit: cover; transition: var(--transition);" />
            <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white; padding: 1.5rem;">
              <h4 style="font-weight: 700; margin-bottom: 0.5rem;">Mercado de San Pedro</h4>
              <p style="font-size: 0.9rem; opacity: 0.9; margin: 0;">Centro de comercio tradicional</p>
            </div>
          </div>
          
          <div class="galeria-item" style="position: relative; overflow: hidden; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); transition: var(--transition);">
            <img src="https://images.unsplash.com/photo-1526392060635-9d6019884377?w=400&h=300&fit=crop" alt="Barrio de San Blas" style="width: 100%; height: 250px; object-fit: cover; transition: var(--transition);" />
            <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white; padding: 1.5rem;">
              <h4 style="font-weight: 700; margin-bottom: 0.5rem;">Barrio de San Blas</h4>
              <p style="font-size: 0.9rem; opacity: 0.9; margin: 0;">Barrio de los artesanos</p>
            </div>
          </div>
          
          <div class="galeria-item" style="position: relative; overflow: hidden; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); transition: var(--transition);">
            <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop" alt="Valle Sagrado" style="width: 100%; height: 250px; object-fit: cover; transition: var(--transition);" />
            <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white; padding: 1.5rem;">
              <h4 style="font-weight: 700; margin-bottom: 0.5rem;">Valle Sagrado</h4>
              <p style="font-size: 0.9rem; opacity: 0.9; margin: 0;">Paisajes que inspiran</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Nueva secci√≥n de Testimonios con dise√±o llamativo -->
    <section id="testimonios" class="page-section" style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
      <div class="container">
        <h2>Lo que Dicen Nuestros Clientes</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 3rem;">
          <div class="testimonio-card" style="background: var(--card-gradient); padding: 2.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); position: relative; border: 1px solid rgba(255, 107, 53, 0.1);">
            <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--hero-gradient); border-radius: var(--radius-lg) var(--radius-lg) 0 0;"></div>
            <div style="font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem;">"</div>
            <p style="font-style: italic; line-height: 1.6; margin-bottom: 1.5rem; color: var(--text-light);">Los productos son de excelente calidad y saber que estoy apoyando directamente a las familias del Cusco me hace sentir muy bien.</p>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 50px; height: 50px; border-radius: 50%; background: var(--hero-gradient); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">A</div>
              <div>
                <h5 style="margin: 0; color: var(--primary-color);">Ana Garc√≠a</h5>
                <p style="margin: 0; font-size: 0.9rem; color: var(--text-light);">Cliente desde 2025</p>
              </div>
            </div>
          </div>
          
          <div class="testimonio-card" style="background: var(--card-gradient); padding: 2.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); position: relative; border: 1px solid rgba(255, 107, 53, 0.1);">
            <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--hero-gradient); border-radius: var(--radius-lg) var(--radius-lg) 0 0;"></div>
            <div style="font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem;">"</div>
            <p style="font-style: italic; line-height: 1.6; margin-bottom: 1.5rem; color: var(--text-light);">Cada pieza cuenta una historia. La atenci√≥n al detalle y la autenticidad de los productos es incomparable.</p>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 50px; height: 50px; border-radius: 50%; background: var(--hero-gradient); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">C</div>
              <div>
                <h5 style="margin: 0; color: var(--primary-color);">Carlos Mendoza</h5>
                <p style="margin: 0; font-size: 0.9rem; color: var(--text-light);">Coleccionista de arte</p>
              </div>
            </div>
          </div>
          
          <div class="testimonio-card" style="background: var(--card-gradient); padding: 2.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); position: relative; border: 1px solid rgba(255, 107, 53, 0.1);">
            <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--hero-gradient); border-radius: var(--radius-lg) var(--radius-lg) 0 0;"></div>
            <div style="font-size: 3rem; color: var(--primary-color); margin-bottom: 1rem;">"</div>
            <p style="font-style: italic; line-height: 1.6; margin-bottom: 1.5rem; color: var(--text-light);">La plataforma es f√°cil de usar y el servicio al cliente es excepcional. Recomiendo Yanapanakunchik a todos mis amigos.</p>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div style="width: 50px; height: 50px; border-radius: 50%; background: var(--hero-gradient); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700;">M</div>
              <div>
                <h5 style="margin: 0; color: var(--primary-color);">Mar√≠a Rodr√≠guez</h5>
                <p style="margin: 0; font-size: 0.9rem; color: var(--text-light);">Empresaria</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <h2>Comun√≠cate con Nosotros</h2>
      <p>¬øInteresado en nuestros productos o en apoyar nuestra causa? Cont√°ctanos.</p>
      <p>Email: <a href="mailto:anapanakunchik@gmail.com">yanapanakunchik@gmail.com</a> | Tel√©fono: +51 987 654 321</p>
      <p><a href="contacto.html" class="cta-button" style="display: inline-block; margin-top: 1rem;">Ver P√°gina de Contacto Completa</a></p>
      
      <div style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #ddd; text-align: center;">
        <p>&copy; 2025 Yanapanakunchik. Todos los derechos reservados.</p>
        <p>Comercio Justo y Sostenible en Cusco, Per√∫</p>
        <div style="margin-top: 1rem;">
          <a href="politica-privacidad.html" style="color: #666; text-decoration: none; margin: 0 1rem;">Pol√≠tica de Privacidad</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Script de protecci√≥n y marca de agua -->
  <script src="protection.js"></script>

  <!-- Login Modal -->
  <div class="modal-overlay" id="login-modal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">Iniciar sesi√≥n</div>
        <button class="modal-close" id="close-login-modal" aria-label="Cerrar">√ó</button>
      </div>
      <div class="modal-body">
        <div class="tabs">
          <button class="tab-button active" data-tab="google-tab">Google</button>
          <button class="tab-button" data-tab="email-tab">Correo / Usuario</button>
        </div>
        <div class="tab-panel active" id="google-tab">
          <div id="g_id_signin_modal"></div>
        </div>
        <div class="tab-panel" id="email-tab">
          <form id="login-form">
            <div class="form-group">
              <label for="username">Usuario o correo</label>
              <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
              <label for="password">Contrase√±a</label>
              <input type="password" id="password" name="password" required>
            </div>
            <div class="form-group" style="display: flex; align-items: center; justify-content: space-between;">
              <label for="remember-me" style="display: flex; align-items: center; margin-bottom: 0; cursor: pointer;">
                <input type="checkbox" id="remember-me" name="remember-me" style="margin-right: 8px;">
                Recordarme
              </label>
            </div>
            <button type="submit">Entrar</button>
          </form>
          <p style="text-align:center;margin-top:10px;">¬øNo tienes cuenta? <a href="register.html">Reg√≠strate</a></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    function decodeJwtResponse(token) {
        var base64Url = token.split('.')[1];
        var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
        return JSON.parse(jsonPayload);
    }

    function handleCredentialResponse(response) {
      const responsePayload = decodeJwtResponse(response.credential);
      console.log("Logged in as: " + responsePayload.name);
      
      sessionStorage.setItem("userName", responsePayload.name);
      sessionStorage.setItem("userPic", responsePayload.picture);
      sessionStorage.setItem("userCredential", response.credential);

      updateUI(responsePayload.name, responsePayload.picture);
      closeLoginModal();
    }

    function updateUI(name, pic) {
        const authActions = document.getElementById('auth-actions');
        if (authActions) authActions.style.display = 'none';
        const userProfile = document.getElementById('user-profile');
        if (userProfile) {
            userProfile.style.display = "flex";
            document.getElementById('user-pic').src = pic;
            document.getElementById('user-name').innerText = name;
        }
    }

    function signOut() {
        google.accounts.id.disableAutoSelect();
        sessionStorage.clear();
        localStorage.removeItem('user'); // Borrar usuario recordado
        const authActions = document.getElementById('auth-actions');
        if (authActions) authActions.style.display = 'flex';
        const userProfile = document.getElementById('user-profile');
        if (userProfile) {
            userProfile.style.display = "none";
        }
        console.log('User signed out.');
    }

    // Modal logic
    const modalEl = document.getElementById('login-modal');
    const openBtn = document.getElementById('open-login-modal');
    const closeBtn = document.getElementById('close-login-modal');

    function openLoginModal() {
      modalEl.classList.add('open');
    }
    function closeLoginModal() {
      modalEl.classList.remove('open');
    }

    if (openBtn) openBtn.addEventListener('click', openLoginModal);
    if (closeBtn) closeBtn.addEventListener('click', closeLoginModal);
    modalEl.addEventListener('click', (e) => { if (e.target === modalEl) closeLoginModal(); });

    // Tabs
    document.querySelectorAll('.tab-button').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
        btn.classList.add('active');
        const panel = document.getElementById(btn.dataset.tab);
        if (panel) panel.classList.add('active');
      });
    });

    // Enhanced login validation
    function validateLoginForm(formData) {
        const errors = [];
        
        if (!formData.username || formData.username.trim() === '') {
            errors.push('El usuario o correo es requerido');
        }
        
        if (!formData.password || formData.password.trim() === '') {
            errors.push('La contrase√±a es requerida');
        }
        
        if (formData.username && formData.username.includes('@')) {
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(formData.username)) {
                errors.push('El formato del correo electr√≥nico no es v√°lido');
            }
        }
        
        return errors;
    }

    function showLoginError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.className = 'login-error';
        errorDiv.textContent = message;
        errorDiv.style.cssText = `
            background: #ffebee;
            color: #c62828;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #ffcdd2;
            font-size: 14px;
        `;
        
        const form = document.getElementById('login-form');
        const existingError = form.querySelector('.login-error');
        if (existingError) {
            existingError.remove();
        }
        form.insertBefore(errorDiv, form.firstChild);
        
        setTimeout(() => {
            if (errorDiv.parentNode) {
                errorDiv.remove();
            }
        }, 5000);
    }

    function showLoginSuccess(message) {
        const successDiv = document.createElement('div');
        successDiv.className = 'login-success';
        successDiv.textContent = message;
        successDiv.style.cssText = `
            background: #e8f5e8;
            color: #2e7d32;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #c8e6c9;
            font-size: 14px;
        `;
        
        const form = document.getElementById('login-form');
        const existingSuccess = form.querySelector('.login-success');
        if (existingSuccess) {
            existingSuccess.remove();
        }
        form.insertBefore(successDiv, form.firstChild);
        
        setTimeout(() => {
            if (successDiv.parentNode) {
                successDiv.remove();
            }
        }, 3000);
    }

    // Enhanced form submission for login
    document.addEventListener('DOMContentLoaded', function() {
        const loginForm = document.getElementById('login-form');
        if (loginForm) {
            loginForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const formData = {
                    username: this.username.value.trim(),
                    password: this.password.value
                };
                
                // Validate form
                const errors = validateLoginForm(formData);
                if (errors.length > 0) {
                    showLoginError(errors.join(', '));
                    return;
                }
                
                try {
                    const response = await fetch(`http://localhost:3000/users?username=${encodeURIComponent(formData.username)}&password=${encodeURIComponent(formData.password)}`);
                    const users = await response.json();
                    
                    if (users.length > 0) {
                        // Login successful
                        const rememberMe = document.getElementById('remember-me').checked;
                        if (rememberMe) {
                            localStorage.setItem('user', JSON.stringify(users[0]));
                        } else {
                            sessionStorage.setItem('user', JSON.stringify(users[0]));
                        }

                        showLoginSuccess('Inicio de sesi√≥n exitoso');
                        closeLoginModal();
                        
                        // Reload to update UI
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else {
                        showLoginError('Usuario o contrase√±a incorrectos');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    showLoginError('Error de conexi√≥n. Verifica que el servidor est√© ejecut√°ndose.');
                }
            });
        }
    });

    window.onload = function () {
      google.accounts.id.initialize({
        client_id: "79813298776-jctbcrchdefnv2vdbpqvj2fghf0gjqgf.apps.googleusercontent.com",
        callback: handleCredentialResponse
      });
      
      // Check for persisted sessions (Google or local)
      const userCredential = sessionStorage.getItem("userCredential");
      const localUserJson = localStorage.getItem('user') || sessionStorage.getItem('user');

      if (userCredential) {
        const payload = decodeJwtResponse(userCredential);
        updateUI(payload.name, payload.picture);
      } else if (localUserJson) {
        const userData = JSON.parse(localUserJson);
        // Usamos el nombre de usuario y una imagen gen√©rica
        updateUI(userData.username, `https://ui-avatars.com/api/?name=${encodeURIComponent(userData.username)}&background=008080&color=fff`);
      } else {
        // Render Google button in modal if no one is logged in
        const target = document.getElementById("g_id_signin_modal");
        if (target) {
          google.accounts.id.renderButton(target, { theme: "outline", size: "large", text: "signin_with", shape: "rectangular", logo_alignment: "left" });
        }
      }

      // Cookie Consent Logic
      const consentBanner = document.getElementById('cookie-consent-banner');
      if (consentBanner) {
        const acceptBtn = document.getElementById('accept-cookies');
        const rejectBtn = document.getElementById('reject-cookies');
        const cookieConsent = localStorage.getItem('cookieConsent');

        if (!cookieConsent) {
          setTimeout(() => {
            consentBanner.classList.add('show');
          }, 1500);
        }

        acceptBtn.addEventListener('click', () => {
          localStorage.setItem('cookieConsent', 'accepted');
          consentBanner.classList.remove('show');
        });

        rejectBtn.addEventListener('click', () => {
          localStorage.setItem('cookieConsent', 'rejected');
          consentBanner.classList.remove('show');
        });
      }
    };
  </script>
  <script src="auth.js"></script>
  <!-- Cookie Consent Banner -->
  <div class="cookie-consent-banner" id="cookie-consent-banner">
    <p>Utilizamos cookies para la funcionalidad de "Recordarme". Al aceptar, consientes su uso.</p>
    <div class="buttons">
      <button class="accept-btn" id="accept-cookies">Aceptar</button>
      <button class="reject-btn" id="reject-cookies">Rechazar</button>
    </div>
  </div>
</body>
</html>
